components:
  schemas:
    paginated_response:
      title: Paginated List response
      type: object
      properties:
        next_page_token:
          type: string
          description: If returned, use the next_page_token to query for the next page of results. Not returned if there are no more rows.
          example: a8937a0d

    error:
      title: Synctera error response
      description: >-
        Synctera error responses in API v1 implement a custom error schema.
      type: object
      # None of these properties can be marked required because of legacy
      # errors returned by api-gateway and mainapi. Once those are
      # fixed, these should all be required.
      properties:
        code:
          type: string
          description: >
            A machine-readable string that identifies the error for programmatic use.
          example: BAD_REQUEST_BODY
        status:
          type: integer
          description: HTTP status code for this response
          example: 400
        detail:
          type: string
          description: >
            A human-readable string explaining this particular error.
          example: "Missing required fields: first_name, dob"

    delete_response:
      title: Deleted Object
      type: object
      description: Deleted object information
      properties:
        id:
          type: string
          format: uuid
          description: Object ID
        resource:
          type: string
          description: The resource name

    vendor_info:
      title: Vendor Info
      type: object
      description: >
        The information provided to Synctera from the vendor.
        Interpretation of this object is up to the client.
      discriminator:
        propertyName: content_type
        mapping:
          "application/json": "#/components/schemas/vendor_json"
          "text/xml": "#/components/schemas/vendor_xml"
      oneOf:
        - $ref: "#/components/schemas/vendor_json"
        - $ref: "#/components/schemas/vendor_xml"

    vendor_json:
      properties:
        vendor:
          type: string
          example: SOCURE
        content_type:
          type: string
          description: Describes the content-type encoding received from the vendor
          enum:
            - "application/json"
        json:
          type: object
          description: Data representation in JSON
      required:
        - vendor
        - content_type
        - json

    vendor_xml:
      properties:
        vendor:
          type: string
          example: IDOLOGY
        content_type:
          type: string
          description: Describes the content-type encoding received from the vendor
          enum:
            - "text/xml"
        xml:
          type: string
          description: Data representaion in XML
      required:
        - vendor
        - content_type
        - xml

    metadata:
      description: >
        Optional field to store additional information about the resource.
        Intended to be used by the integrator to store non-sensitive data.
      type: object

    tenant:
      title: Tenant
      type: object
      properties:
        bank_id:
          description: Bank ID
          type: integer
          example: 6
        partner_id:
          description: Partner ID
          type: integer
          example: 6
      required:
        - bank_id
        - partner_id

    partner:
      title: Partner
      type: object
      properties:
        partner_country:
          description: The country for this partner, a 2 character ISO 3166 string
          type: string
          enum:
            - US
            - CA
      required:
        - partner_country
    tenant_id:
      description: |
        The id of the tenant containing the resource.
      type: string
      example: "abcdef_ghijkl"

    tenant_id_internal:
      x-external: false
      description: |
        The id of the tenant containing the resource. Not included in external documentation.
      type: string
      example: "abcdef_ghijkl"

    workspace_resources_post:
      title: Request for creating workspace resources
      type: object
      properties:
        tenant:
          description: The tenant whose resources are being created as part of this quickstart request.
          allOf:
            - $ref: "#/components/schemas/tenant"
        parent_tenant:
          description: >
            If `tenant` is a fintech, this is the sponsor bank's self-partner tenant.
            If `tenant` is a bank, this is Synctera (1_1).
          allOf:
            - $ref: "#/components/schemas/tenant"
        bank_self_partner_tenant:
          description: >
            If `tenant` is a fintech, this is the sponsor bank's self-partner tenant.
            If `tenant` is a bank, this is the same as `tenant`.
          deprecated: true
          allOf:
            - $ref: "#/components/schemas/tenant"
        is_tminus10:
          description: |
            Flag which indicates if the workspace is a t-minus10 workspace.
            Some services may create different resources depending on this flag.
          type: boolean
        partner_type:
          $ref: "#/components/schemas/partner_type"
        partner:
          description: The partner object.
          allOf:
            - $ref: "#/components/schemas/partner"
      required:
        - tenant
        - is_tminus10
        - partner_type
        - partner

    sample_resources_post:
      title: Request for creating sample resources
      type: object
      properties:
        tenant:
          $ref: "#/components/schemas/tenant"
        partner:
          description: The partner object.
          allOf:
            - $ref: "#/components/schemas/partner"
      required:
        - partner
        - tenant

    workspace_wipe_post:
      title: Request for wiping a workspace
      type: object
      properties:
        tenant:
          $ref: "#/components/schemas/tenant"
      required:
        - tenant

    vendor_config_status:
      type: string
      description: Status of vendor configuration
      enum:
        - NOT_CONTRACTED
        - NOT_CONFIGURED
        - MISCONFIGURED
        - OK

    partner_type:
      type: string
      enum:
        - BANK_SELF_PARTNER
        - FINTECH
        - VENDOR
      description: |
        Type of partner. One of the following:
        * `BANK_SELF_PARTNER` - The partner aspect of a bank tenant.
        * `FINTECH` - A fintech partnered with a bank.
        * `VENDOR` - A vendor providing services to the Synctera platform.

    customer_device:
      type: object
      required:
        - is_system_call
        - ip_address
      properties:
        is_system_call:
          type: boolean
          description: Indicates if the request is made by a system call.
          example: false
        customer_id:
          type: string
          format: uuid
          description: |
            The unique identifier of the customer making the authorized request.
            
            Validation:
              - If `is_system_call` is true, `customer_id` must be null.
              - If `is_system_call` is false, `customer_id` must not be null.
          example: "123e4567-e89b-12d3-a456-426614174000"
        ip_address:
          type: string
          description: The internet-facing IP address assigned by your customer’s ISP. Supports either IPv4 or IPv6 formats.
          example: "203.0.113.195"
        device_type:
          type: string
          description: The name or operating system of the authorized device.
          example: "iOS"
        user_agent:
          type: string
          description: The user agent of the end-customer’s browser on the authorized device.
          example: "Mozilla/5.0 (iPhone; CPU iPhone OS 14_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.0 Mobile/15E148 Safari/604.1"
