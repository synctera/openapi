components:
  schemas:
    customer_verification:
      title: PersonVerification
      type: object
      properties:
        verification_type:
          type: array
          items:
            $ref: "#/components/schemas/verification_type"
        user_ip_address:
          type: string
          description: IP address
          pattern: '^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$'
          example: faker.internet.ip
      required:
        - verification_type

    customer_verification_result:
      title: CustomerVerificationResult
      description: Verification result
      type: object
      properties:
        id:
          description: Verification object ID
          type: string
          format: uuid
          example: faker.random.uuid
        issues:
          description: List of found issues
          type: array
          items:
            $ref: "#/components/schemas/customer_verification_reason_codes"
        verifications_run:
          description: List of the verifications run
          type: array
          items:
            $ref: "#/components/schemas/verification_type"
        raw_response:
          $ref: '#/components/schemas/raw_response'
        result:
          description: The determination of this KYC run
          type: string
          enum:
            - accept
            - reject
            - pending
            - review
            - resubmit
            - refer
          example: PASS
        verification_date:
          description: The date on which the KYC run was completed
          type: string
          format: date
          example: faker.date.past
      required:
        - verifications_run
        - result
        - verification_date

    customer_verification_result_list:
      allOf:
        - type: object
          required:
            - verifications
          properties:
            verifications:
              type: array
              description: Array of Verification results
              items:
                $ref: '#/components/schemas/customer_verification_result'
        - $ref: '../common/schemas.yml#/components/schemas/paginated_response'

    customer_verification_reason_codes:
      title: PersonVerificationReasonCodes
      type: string
      enum:
        - NAME
        - ADDRESS
        - SSN_ADDRESS_MISMATCH
        - NON_US_CITIZEN
        - IDENTITY_TOO_RECENT
        - GLOBAL_WATCHLIST
        - EMAIL_FRAUD_LIST
        - SSN_FRAUD_LIST
        - PHONE_FRAUD_LIST
        - DOB
        - SSN_DECEASED
        - SSN
        - SSN_NAME_MISMATCH
        - ACTIVE_DUTY
        - FRAUD_VICTIM
      description: Specific verification issue.  Based on rules defined with bank this may
      # NOTE: deepmap has problems with newlines in descriptions. It tries to generate a comment with newlines in it.
      # description: |
      #   Specific verification issue.  Based on rules defined with bank this may
      #   result in a manual review or rejection
      #   * `NAME` - Name did not return a full match
      #   * `ADDRESS` - Address did not match identity
      #   * `SSN_ADDRESS_MISMATCH` - Address did not match SSN
      #   * `NON_US_CITIZEN` - Not a US citizen
      #   * `IDENTITY_TOO_RECENT` - Identity is too recent
      #   * `GLOBAL_WATCHLIST` - User found on global watchlist
      #   * `EMAIL_FRAUD_LIST` - Email found on fraud list
      #   * `SSN_FRAUD_LIST` - SSN found on fraud list
      #   * `PHONE_FRAUD_LIST` - Phone found on fraud list
      #   * `DOB` - DOB did not match identity
      #   * `SSN_DECEASED` - SSN matched deceased individual
      #   * `SSN` - Issue with SSN
      #   * `SSN_NAME_MISMATCH` - SSN did not match name
      #   * `ACTIVE_DUTY` - Identity assosciated with someone on active duty
      #   * `FRAUD_VICTIM` - Identity associated with reported fraud
      example: NAME

    document:
      title: Document
      type: object
      properties:
        id:
          type: string
          description: Document ID
          format: uuid
          readOnly: true
          example: faker.random.uuid
        media_type:
          $ref: "#/components/schemas/kyc_media_type"
        document_type:
          $ref: "#/components/schemas/document_type"
        byte_data:
          type: string
          format: byte
          description: Base64url encoded image
          example: faker.random.alphaNumeric(200)
      required:
        - media_type
        - document_type

    document_list:
      allOf:
        - type: object
          required:
            - documents
          properties:
            documents:
              type: array
              description: Array of documents
              items:
                $ref: '#/components/schemas/document'
        - $ref: '../common/schemas.yml#/components/schemas/paginated_response'

    document_data:
      title: DocumentData
      description: Document Data
      type: object
      properties:
        person:
          $ref: "../customers/schemas.yml#/components/schemas/customer"
        expiration_date:
          type: string
          format: date
          description: Date of expiration
        issue_date:
          type: string
          format: date
          description: Date of issuance

    document_type:
      title: DocumentType
      type: string
      enum:
        - LICENSE_FRONT
        - LICENSE_BACK
        - ID_CARD_FRONT
        - ID_CARD_BACK
        - PASSPORT
        - SELF_PORTRAIT
        - PROOF_OF_ADDRESS
      description:
        "Type of document: `LICENSE_FRONT` - Government issued license front, `LICENSE_BACK` - Government issued license back, `ID_CARD_FRONT` - Government issued ID front, `ID_CARD_BACK` - Government issued ID back, `PASSPORT` - Passport, `SELF_PORTRAIT` - Selfie, `PROOF_OF_ADDRESS` - Document to prove address such as a utility bill"
        # NOTE: deepmap has problems with newlines in descriptions. It tries to generate a comment with newlines in it.
        # Type of document
        # * `LICENSE_FRONT` - Government issued license front
        # * `LICENSE_BACK` - Government issued license back
        # * `ID_CARD_FRONT` - Government issued ID front
        # * `ID_CARD_BACK` - Government issued ID back
        # * `PASSPORT` - Passport
        # * `SELF_PORTRAIT` - Selfie
        # * `PROOF_OF_ADDRESS` - Document to prove address such as a utility bill
      example:
        - LICENSE_FRONT

    documents_verification:
      title: DocumentsVerification
      description: Verification result
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Verification object ID
          example: faker.random.uuid
        issues:
          type: array
          items:
            $ref: "#/components/schemas/documents_verification_reason_codes"
        verifications_run:
          type: array
          items:
            $ref: "#/components/schemas/verification_type"
        document_data:
          $ref: "#/components/schemas/document_data"
        raw_response:
          $ref: '#/components/schemas/raw_response'
        result:
          description: The determination of this KYC run
          type: string
          enum:
            - PASS
            - FAIL
            - PENDING
          example: PASS
        verification_date:
          description: The date on which the KYC run was completed
          type: string
          format: date
          example: faker.date.past
      required:
        - verifications_run
        - result
        - verification_date
    
    raw_response:
      title: Raw Response From Providers
      type: object 
      properties:
        provider:
          $ref: "#/components/schemas/provider_type"
        raw_data:
          type: string 

    provider_type:
      type: string 
      enum:
        - IDEOLOGY
        - SOCURE

    documents_verification_reason_codes:
      title: DocumentsVerificationReasonCodes
      type: string
      enum:
        - IMAGE_RESOLUTION
        - IMAGE_FOCUS
        - IMAGE_GLARE
        - IMAGE_COLOR
        - IMAGE_SOFTWARE_MODIFIED
        - IMAGE_INTEGRITY
        - IMAGE_ALTERED
        - NAME
        - ADDRESS
        - DOB
        - EXPIRED
        - CANNOT_READ_BARCODE
        - SELF_PORTRAIT
        - BARCODE_PERSONAL_DATA_MISMATCH
        - TEMPORARY
        - UNABLE_TO_CLASSIFY
      example: IMAGE_RESOLUTION

    kyc_media_type:
      title: MediaType
      type: string
      enum:
        - PDF
        - PNG
        - JPG
        - GIF
      # NOTE: deepmap has problems with newlines in descriptions. It tries to generate a comment with newlines in it.
      # description: |
      #   Type of image
      #   * `PDF` - Media type application / pdf
      #   > **_NOTE:_**: currently unsupported
      #   * `PNG` - Media type image/png
      #   * `JPG` - Media type image/jpg
      #   * `GIF` - Media type image/gif
      #   > **_NOTE:_**: currently unsupported
      description: "Type of image: PNG, JPG. Note that PDF and GIF are valid values, but not currently supported."
      example: PNG

    verification_type:
      title: VerificationType
      type: string
      enum:
        - fraud
        - synthetic
        - emailrisk
        - phonerisk
        - addressrisk
        - kyc
        - social
        - watchliststandard
        - watchlistpremier
        - watchlistplus
        - documentverification
        - alertlist
      description: "Type of verification to run: `KYC` - KYC verification to validate name, date of birth, tax id, etc match, OFAC` - OFAC / sanctions check, `PEP` - Politically exposed persons check, `FRAUD` - Check if transaction is fraudulent, `DOCUMENT` - Validate if document matches Person's identity"
      # NOTE: deepmap has problems with newlines in descriptions. It tries to generate a comment with newlines in it.
      # description: |
      #   Type of verification to run
      #   * `KYC` - KYC verification to validate name, date of birth, tax id, etc match
      #   * `OFAC` - OFAC / sanctions check
      #   * `PEP` - Politically exposed persons check
      #   * `FRAUD` - Check if transaction is fraudulent
      #   * `DOCUMENT` - Validate if document matches Person's identity
      example: KYC
