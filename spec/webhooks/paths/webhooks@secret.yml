post:
  summary: Create a secret
  operationId: createSecret
  description: Create a webhook secret. The secret will be used to verify all subsequent webhook request signature.
  tags:
    - Webhooks
  responses:
    '201':
      description: Webhook secret response
      content:
        application/json:
          schema:
            type: object
            properties:
              secret:
                type: string
                minLength: 64
                maxLength: 64
                description: Generated secret. Do not share. This secret will be used to verify that webhook requests were sent from Synctera.
    '401':
      $ref: '../../common/responses.yml#/components/responses/unauthorized'
    '409':
      $ref: '../../common/responses.yml#/components/responses/already_exists'
    '500':
      $ref: '../../common/responses.yml#/components/responses/internal_server_error'

put:
  summary: Replace an existing secret
  operationId: replaceSecret
  description: Replace an existing webhook secret immediately or as part of rotation. This new secret will be used to verify all subsequent webhook request signature.
  tags:
    - Webhooks
  requestBody:
    required: true
    content:
      application/json:
        schema:
          type: object
          properties:
            is_rolling_secret:
              type: boolean
              description: Set true to let the current secret expire in the next 24 hours. Set false to let the current secret expire immediately.
  responses:
    '200':
      description: Webhook secret response
      content:
        application/json:
          schema:
            type: object
            properties:
              secret:
                type: string
                minLength: 64
                maxLength: 64
                description: Generated secret. Do not share. This secret will be used to verify that webhook requests were sent from Synctera.
              delete_at:
                type: string
                format: date-time
                description: Timestamp that the old secret is delete
    '401':
      $ref: '../../common/responses.yml#/components/responses/unauthorized'
    '404':
      $ref: '../../common/responses.yml#/components/responses/not_found'
    '500':
      $ref: '../../common/responses.yml#/components/responses/internal_server_error'

delete:
  summary: Revoke the secret
  operationId: revokeSecret
  description: Revoke the existing webhook secret. If this is called at the rolling secret time, then both old and new secrets will be revoked
  tags:
    - Webhooks
  responses:
    '200':
      description: Secret has been revoked
    '401':
      $ref: '../../common/responses.yml#/components/responses/unauthorized'
    '404':
      $ref: '../../common/responses.yml#/components/responses/not_found'
    '500':
      $ref: '../../common/responses.yml#/components/responses/internal_server_error'
