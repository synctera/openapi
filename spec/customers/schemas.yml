components:
  schemas:
    customer:
      title: Customer
      type: object
      description: Represents a Customer's information
      properties:
        id:
          description: Customer unique identifier
          type: string
          readOnly: true
          format: uuid
          example: faker.random.uuid
        first_name:
          description: Customer's first name
          type: string
          example: faker.name.firstName
        last_name:
          description: Customer's last name
          type: string
          example: faker.name.lastName
        middle_name:
          description: Customer's middle name
          type: string
          example: faker.name.middleName
        legal_address:
          description: Customer's legal address
          $ref: "../common/schemas.yml#/components/schemas/address"
        shipping_address:
          description: Customer's shipping address
          $ref: "../common/schemas.yml#/components/schemas/address"
        dob:
          description: Customer's date of birth in ISO-8601 date format YYYY-MM-DD
          type: string
          format: date
          example: 2000-01-01
        ssn:
          description: Customer's full tax ID eg SSN formatted with hyphens 123-45-6789
          type: string
          pattern: '^\d{3}-\d{2}-\d{4}$'
          writeOnly: true
          example: faker.helpers.replaceSymbols(###-##-####)
        ssn_last_four:
          description: Customer's masked tax ID eg SSN formatted with hyphens ***-**-6789
          type: string
          pattern: '^\d{3}-\d{2}-\d{4}$'
          readOnly: true
          example: "***-**-6789"
        email:
          description: Customer's email
          type: string
          example: faker.internet.email
        mobile_phone_number:
          description: Customer's mobile phone number in E.164 format e.g. +19178675309
          type: string
          pattern: '^\+?[1-9]\d{1,14}$' # E.164 regex from https://stackoverflow.com/questions/6478875/regular-expression-matching-e-164-formatted-phone-numbers
          example: faker.helpers.replaceSymbols(+###########)
        alt_phone_number:
          description: Customer's alternate phone number in E.164 format e.g. +19178675309
          type: string
          pattern: '^\+?[1-9]\d{1,14}$' # E.164 regex from https://stackoverflow.com/questions/6478875/regular-expression-matching-e-164-formatted-phone-numbers
          example: faker.helpers.replaceSymbols(+###########)
        creation_time:
          type: string
          format: date-time
          readOnly: true
          example: faker.date.past
        last_updated_time:
          type: string
          format: date-time
          readOnly: true
          example: faker.date.past
        devices:
          description: List of the Customer's associated devices
          type: array
          items:
            $ref: "#/components/schemas/device"
        related_customers:
          description: Customer's relationships with other accounts eg. guardian
          type: array
          items:
            $ref: "#/components/schemas/relationship"
        accounts:
          description: List of accounts that belong to the customer
          type: array
          items:
            $ref: "../accounts/schemas.yml#/components/schemas/account"
          readOnly: true
      required:
        - first_name
        - last_name
        - legal_address
        - email
        - dob
        - shipping_address
        - mobile_phone_number

    device:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Resource ID for device
          example: faker.random.uuid
        ip:
          type: string
          description: IP address
          example: faker.internet.ip
        os:
          type: string
          description: Operation system
          example: Android
        os_version:
          type: string
          description: Operation system version
          example: faker.helpers.replaceSymbols(##.##.##)
        screen_width:
          type: integer
          description: Device screen width
          example: faker.random.number(1000)
        screen_height:
          type: integer
          description: Device screen height
          example: faker.random.number(1000)

    relationship:
      title: Relationship
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: ID of related entity
          example: faker.random.uuid
        relationship_role:
          $ref: "#/components/schemas/relationship_role"

    relationship_role:
      title: Relationship Role
      type: string
      enum:
        - CUSTODIAN
        - BENEFICIARY
        - PARTNER
      description: CUSTODIAN - Related party is the custodian e.g. the parent, BENEFICIARY - Related party is the beneficiary e.g. the dependent, PARTNER - Related party is the partner
      # TODO deepmap has problems with newlines in comments
      # description: |
      #   * CUSTODIAN - Related party is the custodian e.g. the parent
      #   * BENEFICIARY - Related party is the beneficiary e.g. the dependent
      #   * PARTNER - Related party is the partner
      example: CUSTODIAN
